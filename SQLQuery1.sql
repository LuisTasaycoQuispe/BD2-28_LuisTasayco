
Use master;
Create Database dbMarket2023;

USE dbMarket2023;

ALTER TABLE dbMarket
ADD FILE
(
	NAME = Market2023,
	FILENAME = 'C:\VENTAS\Market2023.mdf',
	SIZE=15MB,
	MAXSIZE=50MB,
	FILEGROWTH= 5MB
)

ALTER TABLE dbMarket
ADD FILE
(
	NAME = Market_Data,
	FILENAME = 'C:\VENTAS\Market2023.ndf',
	SIZE=30MB,
	MAXSIZE=100MB,
	FILEGROWTH= 25%
)


ALTER TABLE dbMarket
ADD FILE
(
	NAME = Market_Log,
	FILENAME = 'C:\VENTAS\Market2023.ldf',
	SIZE=60MB,
	MAXSIZE=150MB,
	FILEGROWTH= 20%
)

Create Schema PERSONA;
Create Schema PRODUCTO;
Create Schema VENTA;


CREATE TABLE PERSONA(
	IDPER INT PRIMARY KEY IDENTITY(1,1),
	DNIPER char(8),
	NOMPER VARCHAR(30),
	APEPER VARCHAR(20),
	EMAPER VARCHAR(60),
	CELPER CHAR(9),
	TIPPER CHAR(1),
	ESTEPER CHAR(1) DEFAULT 'A',
	FECNACPER DATE
)

INSERT INTO PERSONA
(
	DNIPER,
	NOMPER,
	APEPER,
	EMAPER,
	CELPER,
	TIPPER,
	FECNACPER
)
VALUES
(77889955,'Alberto','Solano Pariona', 'alberto.pariona@empresa.com',998456321,'V','10-2-1970'),
(45781233,'Alicia', 'Garcia Campos','alicia.garcia@gmail.com',929185263,'C','20-3-1980'),
(15487922,'Juana','Avila Chumpitaz', 'juana.avila@gmail.com',923568741,'C','6-6-1986'),
(22116633,'Ana', 'Enriquez Chumpitaz','ana.enriquez@empresa.com',9788488551,'V','10-2-1970'),
(88741589,'Claudia','Perales Ortiz','claudia.perales@yahoo.com',997845263,'C','25-7-2982'),
(45122587,'Mario','Barrio Martinez','mario.barrio@outlook.com',986535874, 'C','10-10-1987'),
(15258564,'Brunela','Tarazona Guerra','brunela.tarazona@gmail.com',986525877,'C','6-6-1990');

CREATE SEQUENCE SECUENCIAS
START WITH 10
INCREMENT BY 10
MINVALUE 10
MAXVALUE 10000

CREATE TABLE CATEGORIA
(
	IDCAT INT DEFAULT NEXT  VALUE FOR SECUENCIAS,
	NOMCAT VARCHAR(30)
)

INSERT INTO CATEGORIA
(NOMCAT)
VALUES
('Abarrotes'),
('Carnes y Pollo'),
('Higiene y Limpieza');

SELECT*FROM CATEGORIA;

CREATE TABLE PRODUCTO
(
	CODPROD CHAR(3),
	NOMPRO VARCHAR(20),
	PREPRO DECIMAL(8,2),
	STOCKPRO INT,
	IDCATPRO INT,
	ESTPRO CHAR(1) DEFAULT 'A'
)

INSERT INTO PRODUCTO
(
	CODPROD,
	NOMPRO,
	PREPRO,
	STOCKPRO,
	IDCATPRO
)

VALUES
('P01','Arroz',4.65,50,10),
('P02','Azucar',3.45,60,10),
('P03','Pollo Fresco',8.70,20,20),
('P04','Lomo Fino',18.50,40,20),
('P05','Detergente Opal',8.75,60,30),
('P06','Suavizante Ariel',7.85,30,30);

Select*from PRODUCTO;

CREATE TABLE VENTA
(
	IDVEN INT IDENTITY(1,1) PRIMARY KEY,
	FECVEN DATETIME,
	IDVEND INT,
	IDCLI INT,
	TIPPAGVEN CHAR(1),
	ESTVEN CHAR(1) DEFAULT 'A'
)


INSERT INTO VENTA
(
	IDVEND,
	IDCLI,
	TIPPAGVEN
)
VALUES
(200,202,'E'),
(200,204,'T'),
(203,205,'T'),
(203,206,'E');

SELECT *FROM VENTA

CREATE TABLE VENTA_DETALLE
(
	IDVENT INT,
	IDVEN INT,
	CODPRO CHAR(3),
	CANVENDET INT
)

INSERT INTO VENTA_DETALLE
(
	IDEVENDET
	IDVEN

)
VALUES

ALTER TABLE VENTA
ADD CONSTRAINT VENTA_PERSONA FOREIGN KEY (PERSONA_IDPER)
REFERENCES PERSONA (IDPER)
ON UPDATE CASCADE 
ON DELETE CASCADE;
